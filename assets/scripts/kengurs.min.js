function statusChangeCallback(a){}function makeLocation(a){$("#save-location").data("classified",a),$("div.si-wrapper-top").hide(),clearOverlays(),classifiedmarker=map.addMarker({lat:56.946618,lng:24.097274,icon:addmarkerIcon,draggable:!0,setlocation:!0,zIndex:999999,dragend:function(a){var b=a.latLng.lat(),c=a.latLng.lng();$("#save-location").data("lat",b),$("#save-location").data("lng",c)},title:"Klikšķini & velc, lai norādītu sludinājuma atrašanās vietu!"}),classifiedmarker.setZIndex(999999),$("#save-location").show(),$(".show-modal").addClass("out").removeClass("show-modal in"),$("#modals").removeClass("show-modals"),setTimeout(function(){$(".lean-modal").removeClass("out")},600),map.panTo(classifiedmarker.getPosition())}function clearOverlays(){for(var a=0;a<allMarkers.length;a++)allMarkers[a].setMap(null);allMarkers.length=0}window.addEventListener("load",function(){FastClick.attach(document.body)},!1),document.addEventListener("touchstart",function(){},!0),Dropzone.autoDiscover=!1;var map;$(document).ready(function(){$("#img-upload").dropzone({paramName:"file",maxFilesize:10,uploadMultiple:!0,parallelUploads:1,maxFiles:5,createImageThumbnails:!0,thumbnailWidth:null,thumbnailHeight:null,clickable:!0,addRemoveLinks:!0,dictDefaultMessage:"Nomet attēlus šeit",dictRemoveFile:"Izņemt failu",dictMaxFilesExceeded:"Sasniegts failu limits",acceptedFiles:"image/*",accept:function(a,b){b()},init:function(){this.on("addedfile",function(){})}}),$.fn.extend({leanModal:function(){function b(b){$(document.body).addClass("noscroll"),a.addClass("show-modals"),$(b).addClass("show-modal in").removeClass("out"),setTimeout(function(){$(".lean-modal").removeClass("in")},600)}function c(b){$(document.body).removeClass("noscroll"),a.removeClass("show-modals"),$(b).addClass("out").removeClass("show-modal in"),setTimeout(function(){$(".lean-modal").removeClass("out")},600)}function d(){c(),$(".show-modal").addClass("out").removeClass("show-modal in")}var a=$("#modals");return window.onhashchange=function(a){window.location.hash?(d(),window.location.hash&&$(window.location.hash+".lean-modal").length&&b(window.location.hash)):d()},this.each(function(){window.location.hash&&$(window.location.hash+".lean-modal").length&&b(window.location.hash),$(this).click(function(){d(),b($(this).attr("href"))}),$(".close-modal, #lean-mask").on("click",function(a){d(),history.pushState("",document.title,window.location.pathname),event.preventDefault()})})}}),$("a[rel*=leanModal]").leanModal(),$(document).on("click",".button.agree",function(a){document.getElementById("signup-agree").checked=!0,$(".button.confirm").removeClass("disabled")}),$(document).on("click",".button.disagree",function(a){document.getElementById("signup-agree").checked=!1,$(".button.confirm").addClass("disabled")}),$("#signup-agree").change(function(){this.checked?$(".button.confirm").removeClass("disabled"):$(".button.confirm").addClass("disabled")}),$(document).on("click","a.nav-toggle",function(a){a.preventDefault(),$(this).toggleClass("cross"),$("body").toggleClass("noscroll"),$("header").toggleClass("show_nav"),$(".mask").toggleClass("show-mask")});var a=Handlebars.compile($("#marker-content-template").html());map=new GMaps({div:"#map",lat:56.946618,lng:24.097274,zoom:13,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#ffcc00"},{visibility:"on"}]}]});var b={path:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fillColor:"#222",fillOpacity:.95,scale:1.5,strokeColor:"#fff",strokeWeight:2,anchor:new google.maps.Point(12,24)};$.post("library/ajax.php",{action:"retrieve"},function(a){var c=[],d=[];if(a.classifieds.length>0){c=a.classifieds;for(var e=0;e<c.length;e++){var f=c[e];void 0!=f.latitude&&void 0!=f.longitude&&d.push({id:f.id,lat:f.latitude,lng:f.longitude,title:f.title,icon:b,description:f.description,price:f.price,gallery:f.gallery,subtitle:f.subtitle,url:fullAddress+"?id="+f.id})}}allMarkers=map.addMarkers(d)},"json"),map.on("marker_added",function(b){if(1==b.setlocation){var d=(map.markers.indexOf(b),null),e=!1,f=function(){$(d.getWrapper()).removeClass("active"),setTimeout(function(){e=!0,d.close()},300)},d=new SnazzyInfoWindow({marker:b,position:"top",offset:{top:"-55px"},content:"<div>"+b.title+"</div>",showCloseButton:!1,closeOnMapClick:!1,padding:"7px 12px",backgroundColor:"#29cc5a",border:!1,borderRadius:"3px",shadow:!1,fontColor:"#fff",fontSize:"15px"});return d.open(),!1}var d=(map.markers.indexOf(b),null),e=!1,f=function(){$(d.getWrapper()).removeClass("active"),setTimeout(function(){e=!0,d.close()},300)},d=new SnazzyInfoWindow({marker:b,position:"top",offset:{top:"-33px"},content:"<div><strong>"+b.title+"</strong></div><div>"+b.price+" EUR</div>",showCloseButton:!1,closeOnMapClick:!1,padding:"5px 10px",backgroundColor:"rgba(0, 0, 0, 0.7)",border:!1,borderRadius:"0px",shadow:!1,fontColor:"#fff",fontSize:"13px"});d.open(),d=new SnazzyInfoWindow({marker:b,wrapperClass:"custom-window",offset:{top:"-33px"},edgeOffset:{top:0,right:0,bottom:0},border:!1,shadow:!1,closeButtonMarkup:'<button type="button" class="custom-close">&#215;</button>',content:a({title:b.title,subtitle:b.subtitle,body:b.description,gallery:b.gallery,url:b.url}),callbacks:{open:function(){$(this.getWrapper()).addClass("open"),baguetteBox.run(".gallery")},afterOpen:function(){var a=$(this.getWrapper());a.addClass("active"),a.find(".custom-close").on("click",f)},beforeClose:function(){return!!e||(f(),!1)},afterClose:function(){var a=$(this.getWrapper());a.find(".custom-close").off(),a.removeClass("open"),e=!1}}}),"undefined"!=typeof openMarker&&openMarker==b.id&&(map.panTo(b.getPosition()),d.open())}),map.addControl({position:"top_right",content:"Mana atrašanās vieta",style:{margin:"5px",padding:"1px 6px",border:"solid 1px #717B87",background:"#fff"},events:{click:function(){GMaps.geolocate({success:function(a){map.setCenter(a.coords.latitude,a.coords.longitude)},error:function(a){alert("Neizdevās: "+a.message)},not_supported:function(){alert("Tavs pārlūks neatbalsta šo funkciju.")}})}}}),$(".login-fb").on("click",function(a){a.preventDefault(),FB.login(function(a){"connected"===a.status?window.location.reload():"not_authorized"===a.status?alert("Mums radās kļūme tevi autorizējot. Mēģini vēlreiz vai sazinies ar mums info@kengurs.com"):alert("Mums radās kļūme tevi autorizējot. Mēģini vēlreiz vai sazinies ar mums info@kengurs.com")},{scope:"email,public_profile"})})}),$("#post-the-ad").on("click",function(a){a.preventDefault(),$("#post-the-ad span").text("Pievienoju…"),$.post("library/ajax.php",{action:"add",title:$("#title").val(),description:$("#description").val(),price:$("#price").val(),phone:$("#phone").val(),email:$("#email").val()},function(a){"undefined"!=typeof a.errors&&a.errors.length>0?($("#post-the-ad span").text("Pievienot bez kļūmēm"),alert("Kļūme: "+a.errors[0])):makeLocation(a.id)},"json")});var addmarkerIcon={path:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fillColor:"#29cc5a",fillOpacity:1,scale:2.5,strokeColor:"#fff",strokeWeight:2,anchor:new google.maps.Point(12,24)};$("#save-location").on("click",function(a){a.preventDefault(),$.post("library/ajax.php",{action:"location",classified:$(this).data("classified"),lat:$(this).data("lat"),lng:$(this).data("lng")},function(a){"success"==a.result&&(window.location.href=fullAddress)},"json")});
