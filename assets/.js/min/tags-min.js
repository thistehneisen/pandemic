!function(){"use strict";function e(e,n){return"string"==typeof e?(n||document).querySelectorAll(e):[e]}function $(e,n){return"string"==typeof e?(n||document).querySelector(e):e}function n(e,n){var t=document.createElement(e);if(n)for(var i in n)void 0!==t[i]&&(t[i]=n[i]);return t}function t(){var e=document.documentElement,n={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd otransitionend"};for(var t in n)if(void 0!==e.style[t])return n[t];return!1}function i(e,n,t,i){i=i||!1,e.addEventListener(n,function n(r){t.call(this,r),e.removeEventListener(r.type,n,i)},i)}function r(e,n){return new RegExp("(^|\\s+)"+e+"(\\s+|$)").test(n.className)}function a(e,n){if(!r(e,n))return n.className+=""===n.className?e:" "+e}function o(e,n){n.className=n.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)"),"")}function s(e,n){r(e,n)?o(e,n):a(e,n)}function u(s){function u(){C=n("div",{className:"tags-container"}),x=p.cloneNode(!0),C.appendChild(x),""!==p.value.trim()&&c(),p.type="hidden",p.parentNode.insertBefore(C,p.nextSibling),C.addEventListener("click",f,!1),C.addEventListener("keydown",v,!1),C.addEventListener("keyup",d,!1)}function c(){var e=p.value.trim().split(",");e.forEach(function(e){if(e=e.trim(),!~y.indexOf(e)){var n=l(e);y.push(e),C.insertBefore(n,x)}})}function l(e){var t=n("div",{className:"tag",innerHTML:'<span class="tag__name">'+e+'</span><button class="tag__remove">&times;</button>'});return t}function f(e){if(e.preventDefault(),"tag__remove"===e.target.className){var n=e.target.parentNode,t=$(".tag__name",n);C.removeChild(n),y.splice(y.indexOf(t.textContent),1),p.value=y.join(",")}x.focus()}function v(e){if("INPUT"===e.target.tagName&&"tag-input"===e.target.className){var n=e.target,t=e.which||e.keyCode;x.previousSibling&&t!==N.BACK&&o("tag--marked",x.previousSibling);var i=n.value.trim();t===N.ENTER?(n.blur(),g(i),k&&clearTimeout(k),k=setTimeout(function(){n.focus()},10)):t===N.BACK&&(""!==e.target.value||T||(T=!0,m()))}}function d(e){T=!1}function g(n){if(n=n.toString().replace(/,/g,"").trim(),""===n)return x.value="";if(~y.indexOf(n)){var t=e(".tag",C);return Array.prototype.forEach.call(t,function(e){e.firstChild.textContent===n&&(a("tag--exists",e),E?i(e,E,function(){o("tag--exists",e)}):o("tag--exists",e))}),x.value=""}var r=l(n);C.insertBefore(r,x),y.push(n),x.value="",p.value+=""===p.value?n:","+n}function m(){if(0!==y.length){var n=e(".tag",C),t=n[n.length-1];if(!r("tag--marked",t))return void a("tag--marked",t);y.pop(),C.removeChild(t),p.value=y.join(",")}}var p=$(s);if(!p.instance){p.instance=this;var h=p.type,E=t(),y=[],N={ENTER:13,BACK:8},T=!1,k,C,x;u(),this.getTags=function(){return y},this.clearTags=function(){p.instance&&(y.length=0,p.value="",C.innerHTML="",C.appendChild(x))},this.addTags=function(e){if(p.instance){if(Array.isArray(e))for(var n=0,t=e.length;n<t;n++)g(e[n]);else g(e);return y}},this.destroy=function(){p.instance&&(C.removeEventListener("click",f,!1),C.removeEventListener("keydown",v,!1),C.removeEventListener("keyup",v,!1),C.parentNode.removeChild(C),p.type=h,h=null,y=null,k=null,C=null,x=null,delete p.instance)}}}window.Tags=u}();